<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>GestÃ£o de KPIs</title>
  <link rel="stylesheet" href="/static/style.css">
  <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
  <div class="container">
    <header>
      <h1>GestÃ£o de Indicadores (KPI)</h1>
      <button class="theme-toggle" onclick="toggleDarkMode()">ðŸŒ™</button>
    </header>

    <div id="success-message" class="hidden success">âœ… KPI salvo com sucesso!</div>

    <!-- Passo 1: FormulÃ¡rio -->
    <div id="form-step" class="card fade active">
      <h2>Cadastro de Indicadores</h2>
      <form action="/enviar" method="POST" onsubmit="return exibirMensagem()">
        <input type="text" name="kpi" placeholder="Indicador (KPI)" required>
        <input type="text" name="objetivo" placeholder="Objetivo EstratÃ©gico" required>
        <select name="perspectiva" required>
          <option value="">Selecione a Perspectiva</option>
          <option value="Clientes">Clientes</option>
          <option value="Financeira">Financeira</option>
          <option value="Processos Internos">Processos Internos</option>
          <option value="Aprendizado e Crescimento">Aprendizado e Crescimento</option>
        </select>
        <input type="number" name="valor" placeholder="Valor" step="any" required>
        <input type="text" name="responsavel" placeholder="ResponsÃ¡vel" required>
        <input type="text" name="unidade" placeholder="Unidade (%, R$, Horas etc.)" required>
        <textarea name="observacoes" placeholder="ObservaÃ§Ãµes..."></textarea>

        <button class="btn" type="submit">
          <i data-lucide="save"></i> Salvar KPI
        </button>
      </form>
      <button class="btn alt" onclick="mostrarTabela()">
        <i data-lucide="table"></i> Ver Tabela
      </button>
    </div>

    <!-- Passo 2: Tabela -->
    <div id="tabela-step" class="card fade hidden">
      <h2>KPIs Cadastrados</h2>
      {% if dados is not none and not dados.empty %}
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              {% for coluna in dados.columns %}
              <th>{{ coluna }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for _, linha in dados.iterrows() %}
            <tr>
              {% for valor in linha %}
              <td>{{ valor }}</td>
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p>Nenhum KPI cadastrado ainda.</p>
      {% endif %}
      <button class="btn alt" onclick="mostrarFormulario()">
        <i data-lucide="arrow-left"></i> Voltar
      </button>
    </div>
  </div>

  <script>
    lucide.createIcons();

    function mostrarTabela() {
      document.getElementById('form-step').classList.add('hidden')
      document.getElementById('tabela-step').classList.remove('hidden')
    }

    function mostrarFormulario() {
      document.getElementById('tabela-step').classList.add('hidden')
      document.getElementById('form-step').classList.remove('hidden')
    }

    function exibirMensagem() {
      const msg = document.getElementById("success-message")
      msg.classList.remove("hidden")
      setTimeout(() => msg.classList.add("hidden"), 3000)
      return true
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark")
    }
  </script>
  <script src="/static/script.js"></script>
</body>

</html>
